# SakeLogger - あなたの飲酒生活を見える化するExcelツール

SakeLoggerは、毎日の飲酒量を手軽に記録し、純アルコール摂取量を自動で計算・可視化するためのExcelアプリケーションです。健康管理や休肝日の設定など、あなたの飲酒習慣を見直すきっかけを提供します。

![メイン画像](https://github.com/user-attachments/assets/6f1f0908-a375-492c-b6f0-b7e1a44c3bf1)

## SakeLoggerのダウンロード方法

このツールを使用するために、**`SakeLogger.xlsm`というExcelファイルのみ**が必要です。以下の手順でダウンロードしてください。

1.  このGitHubページの上部にあるファイルリストから、`SakeLogger.xlsm` をクリックします。
2.  次の画面で、右側にある「Download」ボタンをクリックします。

    ![GitHubのダウンロードボタンの画像](https://github.com/user-attachments/assets/b5db95f6-ffd9-4e6a-a133-c595c9c853d2)

**【重要】**
他のフォルダ（`vba-files`など）や設定ファイル（`.gitignore`など）は、開発用のファイルです。**ツールを利用するだけであれば、これらのファイルをダウンロードする必要はありません。**

## 主な機能

*   **簡単な飲酒記録:** シンプルな入力フォームから、いつ、どのお酒を、どれくらい飲んだかを簡単に記録できます。
*   **純アルコール量の自動計算:** 飲んだお酒の量とアルコール度数から、純アルコール摂取量を自動で計算。健康管理に役立ちます。
*   **飲酒量の可視化:** 日々の純アルコール摂取量をグラフで表示。飲酒量の推移が一目でわかります。
*   **お酒マスタ管理:** よく飲むお酒をマスタに登録しておくことで、次回からの入力がさらに簡単になります。

## 使い方・操作方法

1.  **初期設定（お酒マスタの登録）**
    1.  ダウンロードした`SakeLogger.xlsm`を開き、「お酒マスタ」シートを選択します。
    2.  あなたが飲むお酒の情報をリストに入力します。詳細は下記の「各シートの役割」を参照してください。

    ![お酒マスタシートの画像](https://github.com/user-attachments/assets/6eb8e61b-095f-4774-87c4-5666ecee6efe)

2.  **飲酒記録の入力**
    1.  「メイン」シート（または任意のシート）にある「記録フォームを開く」ボタンをクリックします。
    2.  表示されたフォームで、以下の情報を入力・選択します。
        *   **日付:** 飲んだ日付を`yyyy/mm/dd`形式で入力します。
        *   **お酒の選択:** 「お酒マスタ」に登録したお酒をプルダウンから選択します。
        *   **開封状態:** 「新品を開けた」か「途中のお酒を飲んだ」かを選択します。
        *   **現在の重量:** ボトルに残っているお酒の重量を測り、入力します。
    3.  「登録」ボタンをクリックすると、記録が「飲酒記録」シートに保存されます。

    ![記録フォームの画像](https://github.com/user-attachments/assets/0a883484-0393-405d-b5cd-7d2cab99436d)

3.  **記録の確認と分析**
    1.  「集計」シートを開きます。
    2.  「集計」ボタンをクリックすると、最新のデータに基づいた日々の純アルコール摂取量と、その推移を示すグラフが表示されます。

    ![集計シート（グラフ）の画像](https://github.com/user-attachments/assets/b48ce49a-2859-4ab8-b843-3c4d72e58ef4)

## 各シートの役割

このExcelファイルには、以下の4つの主要なシートがあります。

### 1. お酒マスタ

**このシートは、あなたが飲むお酒の基本情報を登録するための場所です。** ここに登録した情報が、入力フォームの選択肢や計算の基になります。

| 列ヘッダー | 説明 |
| :--- | :--- |
| `ID` | お酒を識別するためのユニークな番号（半角数字）を入力します。 |
| `お酒の名前` | お酒の名称を入力します。 |
| `種類` | お酒の種類（例：ビール, 焼酎, ワインなど）を入力します。 |
| `度数(%)` | アルコール度数をパーセント（例: 5, 25）で入力します。 |
| `未開封重量(g)` | 新品・未開封状態のボトル全体の重量（g）を入力します。 |
| `空重量(g)` | 飲みきった後の空のボトルの重量（g）を入力します。 |

### 2. 飲酒記録

入力フォームから保存された、日々の飲酒記録がすべて蓄積されるシートです。基本的には、ユーザーが**直接このシートを編集する必要はありません。**

### 3. 集計

「飲酒記録」のデータを基に、日ごとの純アルコール摂取量を自動で集計し、グラフで可視化するシートです。「集計」ボタンを押すことで、常に最新の状態に更新されます。

### 4. 祝日マスタ

**このシートは、飲酒記録のメイン機能とは直接関係ありません。**

このシートは、カレンダー機能の一部として、指定した年の祝日を自動で計算・表示するためのものです。「祝日リストの更新」ボタンで使用されます。日本の祝日に関心がない場合や、この機能を使用しない場合は、**このシートを気にする必要はありません。**

## よくある質問 (FAQ)

*   **Q: ボタンをクリックしても何も起きません。**
    *   A: Excelのマクロが有効になっていない可能性があります。ファイルを開く際に表示されるセキュリティ警告で、「コンテンツの有効化」をクリックしてください。

*   **Q: 新しく「お酒マスタ」に登録したお酒が、入力フォームの選択肢に出てきません。**
    *   A: フォームを一度閉じてから、再度「記録フォームを開く」ボタンをクリックしてください。フォームが開かれるタイミングで、お酒マスタの最新情報が読み込まれます。

## 必要な環境

*   Microsoft Excel (マクロ有効)
*   Windows OS

## 開発者向け情報

*   **開発環境:** Visual Studio Code + XVBA 拡張機能
*   **コード構成:** VBAのソースコードは`vba-files`ディレクトリ以下にモジュールごとに分割して管理されています。
    *   `M_Constants`: 定数管理
    *   `M_SakeForm`: フォーム制御
    *   `M_SakeLogics`: ビジネスロジック（計算処理など）
    *   `M_SheetUtils`: シート操作ユーティリティ

## 今後の改善予定

*   データ入力規則（ドロップダウンリストなど）の追加による入力支援機能の強化
*   集計期間を任意に指定できる機能の追加
